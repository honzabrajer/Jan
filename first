<!doctype html>
<html lang="cs">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Simulátor glykémie (odhad)</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; background:#f4f6f9; margin:0; padding:24px; display:flex; justify-content:center; }
    .card { background:#fff; width:100%; max-width:900px; border-radius:14px; box-shadow:0 10px 30px rgba(0,0,0,.08); padding:20px; }
    h1 { margin:0 0 8px; }
    .row { display:grid; grid-template-columns: 1fr 1fr 1fr 1fr auto; gap:10px; align-items:end; margin-top:14px; }
    label { display:block; font-size:13px; opacity:.85; margin-bottom:6px; }
    input, select { width:100%; padding:10px; border:1px solid #d7dde6; border-radius:10px; }
    button { padding:10px 14px; border:0; border-radius:10px; cursor:pointer; background:#0b5fff; color:#fff; }
    button.secondary { background:#eef2f7; color:#111; }
    table { width:100%; border-collapse:collapse; margin-top:14px; }
    th, td { text-align:left; padding:10px; border-bottom:1px solid #eef2f7; font-size:14px; }
    .muted { font-size:13px; opacity:.75; }
    .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap:14px; margin-top:14px; }
    @media (max-width: 820px){ .row{ grid-template-columns:1fr 1fr; } .grid2{ grid-template-columns:1fr; } }
  </style>
</head>
<body>
<div class="card">
  <h1>Simulátor glykémie (odhad)</h1>
  <div class="muted">
    Edukační simulace. Ne pro diagnostiku ani rozhodování o léčbě. Reálné reakce jsou individuálně velmi variabilní.
  </div>

  <div class="grid2">
    <div>
      <h3>Nastavení</h3>
      <div class="row" style="grid-template-columns:1fr 1fr;">
        <div>
          <label>Základní hladina (mg/dL)</label>
          <input id="baseline" type="number" value="90" min="50" max="200">
        </div>
        <div>
          <label>Citlivost (škála)</label>
          <select id="sensitivity">
            <option value="0.8">Nižší reakce</option>
            <option value="1.0" selected>Střední</option>
            <option value="1.2">Vyšší reakce</option>
          </select>
        </div>
      </div>

      <h3 style="margin-top:18px;">Přidat jídlo</h3>
      <div class="row">
        <div>
          <label>Čas</label>
          <input id="time" type="time" value="08:00">
        </div>
        <div>
          <label>Sacharidy (g)</label>
          <input id="carbs" type="number" value="50" min="0" max="300">
        </div>
        <div>
          <label>GI (0–100)</label>
          <input id="gi" type="number" value="55" min="0" max="100">
        </div>
        <div>
          <label>“Zpomalení” (tuky/bílkoviny)</label>
          <select id="slow">
            <option value="0">žádné</option>
            <option value="10">trochu</option>
            <option value="20">hodně</option>
          </select>
        </div>
        <button id="addBtn">Přidat</button>
      </div>

      <table>
        <thead><tr><th>Čas</th><th>Sacharidy</th><th>GI</th><th>Zpomalení</th><th></th></tr></thead>
        <tbody id="meals"></tbody>
      </table>

      <div style="display:flex; gap:10px; margin-top:12px;">
        <button class="secondary" id="clearBtn">Smazat vše</button>
        <button id="runBtn">Vykreslit den</button>
      </div>
    </div>

    <div>
      <h3>Graf (0:00–24:00)</h3>
      <canvas id="chart" height="300"></canvas>
      <div class="muted" style="margin-top:10px;">
        Tip: Přidej snídani/oběd/večeři a uvidíš skládání vln.
      </div>
    </div>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
  const meals = [];
  const mealsTbody = document.getElementById('meals');

  function timeToMinutes(t){
    const [h,m] = t.split(':').map(Number);
    return h*60 + m;
  }

  function renderMeals(){
    mealsTbody.innerHTML = meals.map((m, idx) => `
      <tr>
        <td>${m.time}</td>
        <td>${m.carbs} g</td>
        <td>${m.gi}</td>
        <td>${m.slow}</td>
        <td><button class="secondary" onclick="removeMeal(${idx})">×</button></td>
      </tr>
    `).join('');
  }

  window.removeMeal = (idx) => {
    meals.splice(idx,1);
